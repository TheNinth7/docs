---
sidebar_position: 6
---

import Drawio from '@theme/Drawio'
import diagrams from '!!raw-loader!./img/diagrams.drawio';

# Start and stop of charging

---
**What you'll learn**: how `available charging power` is calculated in `Solar` and `Min+Solar` mode, and under which conditions charging is started and stopped.

---

The magic of evcc happens in the `Solar` mode, where the vehicle is charged with surplus from your photovoltaic system. The system constantly monitors the `available charging power` (surplus), and starts the charging process if it exceeds the `minimum charging power` required for the vehicle and charger. If the `available charging power` changes, evcc adapts the charging power or stops charging accordingly. 

The `Min+Solar` mode adapts the charging power in the same fashion, but continuously charges the EV with at least `minimum charging power` instead of starting or stopping based on surplus.

For calulating the `available charging power`, an electric meter measuring the power on your grid connection point (grid meter) is important. Power generated by the photovoltaic system can also be measured and displayed, but has no effect on the function, [except if no grid meter is available](./meters#i-have-a-solar-installation-but-i-dont-have-a-readable-grid-connection-meter---can-i-still-use-evcc). Evcc also considers power consumption by batteries and other devices, which may be diverted to vehicle charging depending on your priorities. 

## Calculation of `available charging power`

Let's start with a closer look at the inputs and configuration parameters that are used in the calculation of `available charging power`:

- The most important factor is [grid power](../reference/configuration/site/#metersgrid), which shows available surplus that is fed into the grid.
- With [data from battery systems](../reference/configuration/site/#metersbattery) that are also charged with surplus, evcc can depending on their charge level prioritize vehicle charging. It does that by increasing the charging power of the vehicle, practically forcing the battery to reduce or stop charging. See also the third use case described further below. 
- The same can be done for [other devices](../reference/configuration/site/#metersaux) operated with surplus (“aux” devices).
- The output of your [PV system](../reference/configuration/site/#meterspv) can also be measured, mostly for display purposes. Only if [grid power cannot be measured](./meters#i-have-a-solar-installation-but-i-dont-have-a-readable-grid-connection-meter---can-i-still-use-evcc), you can use PV power and a constant value for assumed house consumption to approximate surplus.
- The actual charging power consumed by the [charger](../devices/chargers) is also measured. If the charger itself does not provide this measurement, [a separate meter](../reference/configuration/loadpoints#meter) can be used. If that is not available as well, then instead the power last set by evcc will be used.

Further, the following configuration parameters are available for customizing the `Solar` mode. With the exception of `loadpoint.enable` and `loadpoint.disable` they also apply to the `Min+Solar` mode.

- The power level set for [`site.residualPower`](../reference/configuration/site/#residualpower) is incorporated into the available charging power.
- [`loadpoint.enable`](../reference/configuration/loadpoints#enable)/[`disable`](../reference/configuration/loadpoints#disable) thresholds control when charging is started and stopped.
- [`loadpoint.phases`](../reference/configuration/loadpoints#phases)/[`minCurrent`](../reference/configuration/loadpoints#mincurrent)/[`maxCurrent`](../reference/configuration/loadpoints#maxcurrent) define the minimum and maximum charging power.
- [`site.prioritySoc`](../reference/configuration/site/#prioritysoc)/[`bufferSoc`](../reference/configuration/site/#buffersoc)/[`bufferStartSoc`](../reference/configuration/site/#bufferstartsoc) define priorities between battery and vehicle charging.
- [`loadpoint.priority`](../reference/configuration/loadpoints/#priority) defines priorities between multiple chargers.
- [`site.maxGridSupplyWhileBatteryCharging`](../reference/configuration/site/#maxgridsupplywhilebatterycharging) deals with situations where vehicle charging is prioritized over battery charging but measured battery power cannot be fully diverted due to limits in the DC/AC interface of the inverter.

The following diagram shows in detail how all these variables are factored into the calculation of `available charging power` and starting and stopping the charging process. Its main focus lies on `Solar` mode in combination with a battery system, but it also covers how systems without battery work as well as the `Min+Solar mode`. The formulas are not necessarily those programmed into evcc, but rather provide a mathematical model that helps understanding how the software works: 

<Drawio content={diagrams} pageId={"logic"} toolbar={"lightbox"} /><br/>

In the next chapter we'll have a look at how `minimum charging power` and `maximum charging power` are calculated.